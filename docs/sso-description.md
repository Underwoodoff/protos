# Описание системы единого входа (SSO)

Система единого входа (SSO) представляет собой gRPC-сервис, реализующий централизованную аутентификацию и авторизацию пользователей. Сервис построен на основе микросервисной архитектуры и обеспечивает безопасное взаимодействие между различными компонентами системы.

В основе работы SSO лежит концепция единой точки входа для аутентификации пользователей. Система поддерживает два основных типа пользователей: обычных пользователей и администраторов. Каждый пользователь имеет уникальный идентификатор, email и хешированный пароль, хранящийся в SQLite базе данных. Администраторы обладают расширенными правами доступа, что позволяет им управлять пользователями и настройками системы.

Процесс аутентификации начинается с регистрации нового пользователя или входа существующего. При регистрации система проверяет уникальность email и создает новую запись в базе данных с хешированным паролем. При входе система проверяет учетные данные пользователя и генерирует JWT-токен, который содержит информацию о пользователе, включая его идентификатор, email и роль. Токен подписывается секретным ключом и имеет ограниченный срок действия.

Взаимодействие с другими сервисами, такими как URL Shortener, происходит через gRPC-интерфейс. SSO предоставляет методы для проверки прав доступа пользователя, включая проверку административных прав. Клиенты могут проверить валидность токена и получить информацию о пользователе, не имея прямого доступа к базе данных.

Система реализует принципы безопасности, включая хеширование паролей с использованием bcrypt, валидацию входных данных, защиту от SQL-инъекций и безопасное хранение конфиденциальной информации. Логирование всех операций позволяет отслеживать действия пользователей и администраторов, что важно для аудита и отладки.

Конфигурация системы осуществляется через YAML-файл, который содержит настройки для подключения к базе данных, параметры JWT-токенов, настройки логирования и другие параметры. Система поддерживает гибкую настройку через переменные окружения, что позволяет легко адаптировать её под различные окружения.

Взаимодействие с URL Shortener происходит через gRPC-клиент, который проверяет права доступа пользователей при создании и управлении короткими ссылками. Это обеспечивает централизованное управление доступом и позволяет легко масштабировать систему, добавляя новые сервисы, которые могут использовать единую систему аутентификации.

Система построена с учетом принципов чистой архитектуры, что обеспечивает модульность, тестируемость и возможность легкого расширения функциональности. Каждый компонент системы имеет четко определенные границы и ответственности, что упрощает поддержку и развитие проекта. 