# Описание архитектуры SSO

Сервис SSO представляет собой систему единой аутентификации, построенную на основе чистой архитектуры и разделенную на несколько логических слоев. В основе системы лежит gRPC API, который обеспечивает взаимодействие с внешними клиентами. Этот слой обрабатывает входящие запросы, валидирует данные и направляет их в соответствующие сервисы.

Основная бизнес-логика системы реализована в слое сервисов, где центральное место занимает Auth сервис. Этот компонент отвечает за все операции аутентификации и авторизации, включая регистрацию новых пользователей, проверку учетных данных и управление правами доступа. Для обеспечения безопасности при передаче данных используется JWT модуль, который генерирует и валидирует токены доступа.

Хранение данных осуществляется в SQLite базе данных, которая содержит две основные таблицы: users и apps. В таблице users хранятся учетные данные пользователей, включая хеши паролей и флаги администратора. Таблица apps содержит информацию о зарегистрированных приложениях, которые могут использовать систему аутентификации.

Вспомогательные компоненты системы включают модуль логирования и конфигурации. Логгер обеспечивает отслеживание всех операций в системе, что важно для безопасности и отладки. Конфигурационный модуль управляет настройками системы, позволяя гибко настраивать параметры работы без изменения кода.

Процесс аутентификации начинается с отправки запроса на Login от клиента через gRPC API. Сервер проверяет корректность входных данных и передает запрос в Auth сервис. После успешной проверки учетных данных генерируется JWT токен, который возвращается клиенту для последующего использования.

При регистрации нового пользователя процесс включает валидацию входных данных, хеширование пароля с использованием безопасных алгоритмов и сохранение информации в базе данных. Система проверяет уникальность email-адреса и возвращает идентификатор созданного пользователя.

Проверка прав администратора осуществляется через отдельный метод IsAdmin, который проверяет соответствующий флаг в базе данных. Этот процесс включает валидацию входных данных и безопасную проверку прав пользователя.

Все компоненты системы тесно интегрированы между собой, но при этом сохраняют четкое разделение ответственности. Это позволяет легко масштабировать отдельные части системы и вносить изменения без влияния на другие компоненты. Система построена с учетом современных требований безопасности и производительности, используя надежные алгоритмы шифрования и эффективные методы хранения данных. 